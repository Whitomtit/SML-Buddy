datatype formula =
  TRUE
  | FALSE
  | NOT of formula
  | ANDALSO of formula * formula
  | ORELSE of formula * formula
  | IMPLY of formula * formula
  | LESS of expr * expr
and expr =
  NUM of int
  | PLUS of expr * expr
  | MINUS of expr * expr;

fun exp_eval (NUM n) = n
  | exp_eval (PLUS (e1, e2)) = (exp_eval e1) + (exp_eval e2)
  | exp_eval (MINUS (e1, e2)) = (exp_eval e1) - (exp_eval e2);

fun f final_op nil = final_op ()
  | f final_op (x::xs) = x * f final_op xs;

fun test 0 = nil
  | test n = n::(test (n-1));

fun cool_func n () = n;

fun test_a_ x 1 = 1
  | test_a_ x 2 = 3
  | test_a_ x n = n;

fun test_b_ x n = n;

fun test_a n = f (cool_func (test_a_ (n + 1) n)) (test n)
fun test_b n = f (cool_func (test_b_ (n * 4) n)) (test n);


fun test_a l = case l of [] => 0 | (_::xs) => op+ (1, (test_a xs))

fun test_b ([]:string list) = 0
  | test_b (x::xs) = (fn (["DD", _, "hello"]:string list) => 1 | _ => 1 + (test_b xs)) (("D" ^ x) :: xs);

fun main n = f (fn () => 5) ([1,2,3,4,5]:int list);